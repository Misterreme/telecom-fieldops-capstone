import type {
  WorkOrderType,
  WorkOrderStatus,
} from '../models/types';

// allowed transitions per work order type; base rules are defined inline
export const transitions: Record<WorkOrderType, Partial<Record<WorkOrderStatus, WorkOrderStatus[]>>> = {
  NEW_SERVICE_INSTALL: {
    DRAFT: ['SUBMITTED'],
    SUBMITTED: ['ELIGIBILITY_CHECK', 'CANCELLED'],
    ELIGIBILITY_CHECK: ['INVENTORY_RESERVATION', 'REJECTED', 'CANCELLED'],
    INVENTORY_RESERVATION: ['SCHEDULED', 'ON_HOLD', 'CANCELLED'],
    ON_HOLD: ['INVENTORY_RESERVATION', 'CANCELLED'],
    SCHEDULED: ['IN_PROGRESS', 'CANCELLED'],
    IN_PROGRESS: ['VERIFICATION', 'CANCELLED'],
    VERIFICATION: ['COMPLETED', 'CANCELLED'],
    // final states map to empty arrays
    COMPLETED: [],
    REJECTED: [],
    CANCELLED: [],
    CONFLICT: [],
  },
  CLAIM_TROUBLESHOOT: {
    DRAFT: ['SUBMITTED'],
    SUBMITTED: ['IN_REVIEW', 'CANCELLED'],
    IN_REVIEW: ['TECH_ASSIGNMENT', 'ON_HOLD', 'CANCELLED'],
    TECH_ASSIGNMENT: ['IN_PROGRESS', 'CANCELLED'],
    IN_PROGRESS: ['VERIFICATION', 'CANCELLED'],
    VERIFICATION: ['COMPLETED', 'CANCELLED'],
    ON_HOLD: ['IN_REVIEW', 'CANCELLED'],
    COMPLETED: [],
    CANCELLED: [],
    CONFLICT: [],
    REJECTED: [],
  },
  PLAN_AND_EQUIPMENT_SALE: {
    DRAFT: ['SUBMITTED'],
    SUBMITTED: ['ELIGIBILITY_CHECK', 'CANCELLED'],
    ELIGIBILITY_CHECK: ['PRODUCT_SELECTION', 'REJECTED', 'ON_HOLD', 'CANCELLED'],
    PRODUCT_SELECTION: ['PAYMENT_CONFIRMATION', 'CANCELLED'],
    PAYMENT_CONFIRMATION: ['FULFILLMENT', 'CANCELLED'],
    FULFILLMENT: ['VERIFICATION', 'ON_HOLD', 'CANCELLED'],
    ON_HOLD: ['FULFILLMENT', 'CANCELLED'],
    VERIFICATION: ['COMPLETED', 'CANCELLED'],
    COMPLETED: [],
    REJECTED: [],
    CANCELLED: [],
    CONFLICT: [],
  },
  EQUIPMENT_ONLY_SALE: {
    DRAFT: ['SUBMITTED'],
    SUBMITTED: ['INVENTORY_RESERVATION', 'CANCELLED'],
    INVENTORY_RESERVATION: ['PAYMENT_CONFIRMATION', 'ON_HOLD', 'CANCELLED'],
    PAYMENT_CONFIRMATION: ['DELIVERY', 'CANCELLED'],
    DELIVERY: ['COMPLETED', 'CANCELLED'],
    ON_HOLD: ['INVENTORY_RESERVATION', 'CANCELLED'],
    COMPLETED: [],
    REJECTED: [],
    CANCELLED: [],
    CONFLICT: [],
  },
  MONTHLY_PAYMENT: {
    DRAFT: ['SUBMITTED'],
    SUBMITTED: ['PAYMENT_VALIDATION', 'CANCELLED'],
    PAYMENT_VALIDATION: ['RECEIPT_ISSUED', 'REJECTED', 'CANCELLED'],
    RECEIPT_ISSUED: ['COMPLETED', 'CANCELLED'],
    REJECTED: [],
    COMPLETED: [],
    CANCELLED: [],
    CONFLICT: [],
  },
  SERVICE_UPGRADE: {
    DRAFT: ['SUBMITTED'],
    SUBMITTED: ['ELIGIBILITY_CHECK', 'CANCELLED'],
    ELIGIBILITY_CHECK: ['PLAN_CHANGE', 'REJECTED', 'CANCELLED'],
    PLAN_CHANGE: ['INVENTORY_RESERVATION', 'SCHEDULED', 'IN_PROGRESS', 'CANCELLED'],
    INVENTORY_RESERVATION: ['SCHEDULED', 'ON_HOLD', 'CANCELLED'],
    SCHEDULED: ['IN_PROGRESS', 'CANCELLED'],
    IN_PROGRESS: ['VERIFICATION', 'CANCELLED'],
    VERIFICATION: ['COMPLETED', 'CANCELLED'],
    ON_HOLD: ['INVENTORY_RESERVATION', 'CANCELLED'],
    COMPLETED: [],
    REJECTED: [],
    CONFLICT: [],
    CANCELLED: [],
  },
  SERVICE_DOWN_OUTAGE: {
    DRAFT: ['SUBMITTED'],
    SUBMITTED: ['TRIAGE', 'CANCELLED'],
    TRIAGE: ['FIELD_DISPATCH', 'CANCELLED'],
    FIELD_DISPATCH: ['IN_PROGRESS', 'CANCELLED'],
    IN_PROGRESS: ['VERIFICATION', 'CANCELLED'],
    VERIFICATION: ['COMPLETED', 'CANCELLED'],
    COMPLETED: [],
    CANCELLED: [],
    CONFLICT: [],
    REJECTED: [],
  },
};